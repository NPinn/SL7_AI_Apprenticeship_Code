import numpy as np
import matplotlib.pyplot as plt


def plot_line(w, ax=None, **kwargs):
    """
    plot_line(w)
    
    Plots a line on the current axis (or supply `ax=...`) corresponding to the
    direction of `w`. `w` must be a 2d vector corresponding to the delta from
    zero in the x and y directions respectively.
    
    Usual keyword arguments for matplotlib plots can be passed in too (such as `color=...`).
    """
    w = np.array(w)   #Â coerce to numpy
    assert isinstance(w, np.ndarray), "w must be a 2 element vector (list)."
    assert len(w) == 2, "w must be a 2 element numpy array."
    assert np.abs(w).sum() > 0, "w cannot be the zero vector"
    ax = plt.gca() if ax is None else ax
    xlim, ylim = ax.get_xlim(), ax.get_ylim()
    
    if w[0] == 0:
        eps = np.finfo(float).eps
        xs = [-eps,eps]
        ax.plot([-eps,eps], [ylim[0]-1, ylim[1]+1], **kwargs)
    else:
        w = [1, w[1]/w[0]]
        xs = np.array([xlim[0] -1, xlim[1]+1])
        ax.plot(xs, w[1]*xs, **kwargs)
    
    ax.set_xlim(xlim)
    ax.set_ylim(ylim)
    return ax
    
 
data = [np.array([ 0.14,  0.04,  0.7 , -0.02,  2.16,  2.17,  2.42,  1.93, -0.85,
       -1.4 ,  2.09,  1.78,  0.66,  1.17,  1.33,  1.03, -0.55, -0.64,
       -0.95, -0.52, -0.63, -0.39,  2.64,  2.89,  0.07,  0.08, -0.17,
       -0.01,  1.38,  0.92,  0.4 ,  1.01, -1.18, -1.26,  1.02,  1.17,
        0.6 ,  0.5 , -1.03, -0.54, -0.06, -0.49, -0.42, -0.06, -0.14,
       -0.31, -0.04, -0.16,  0.74,  1.04, -2.46, -2.71, -0.04,  0.46,
       -0.4 ,  0.15,  0.44,  0.69, -0.45, -0.61]).reshape(30,2),       # original
       np.array([ 0.14,  0.04,  0.7 , -0.02,  2.16,  2.17,  2.42,  1.93, -0.85,
       -1.4 ,  2.09,  1.78,  0.66,  1.17,  1.33,  1.03, -0.55, -0.64,
       -0.95, -0.52, -0.63, -0.39,  2.64,  2.89,  0.07,  0.08, -0.17,
       -0.01,  1.38,  0.92,  0.4 ,  1.01, -1.18, -1.26,  1.02,  1.17,
        0.6 ,  0.5 , -1.03, -0.54, -0.06, -0.49, -0.42, -0.06, -0.14,
       -0.31, -0.04, -0.16,  0.74,  1.04, -3.46, 0.71, -0.04,  0.46,
       -0.4 ,  0.15,  0.44,  0.69, -0.45, -0.61]).reshape(30,2),       # outlier
       np.array([ 0.14, -0.12,  0.7 , -1.09,  2.16,  1.34,  2.42,  0.45, -0.85,
       -1.69,  2.09,  0.63,  0.66,  1.49,  1.33,  0.17, -0.55, -0.53,
       -0.95,  0.32, -0.63,  0.11,  2.64,  2.13,  0.07,  0.07, -0.17,
        0.23,  1.38, -0.13,  0.4 ,  1.54, -1.18, -0.87,  1.02,  0.94,
        0.6 ,  0.17, -1.03,  0.41, -0.06, -0.95, -0.42,  0.49, -0.14,
       -0.46, -0.04, -0.28,  0.74,  1.08, -2.46, -2.03, -0.04,  1.03,
       -0.4 ,  0.9 ,  0.44,  0.79, -0.45, -0.61]).reshape(30,2),       # low corr
        np.array([ 1.03,  1.25, -0.93, -0.97,  0.86,  0.99,  1.83,  1.76,  0.87,
        0.57, -0.16,  0.23,  0.05, -0.2 , -0.35, -0.31,  0.74,  0.79,
        0.23,  0.01, -1.93, -1.67,  1.77,  1.68, -0.87, -1.05, -1.33,
       -1.26,  0.07,  0.02, -1.23,  1.2 ,  0.81, -0.88, -0.98,  1.05,
       -1.92,  1.86, -0.59,  0.75,  0.18,  0.08,  0.11, -0.12,  0.33,
       -0.13, -0.81,  0.89, -0.15,  0.23,  1.88, -1.6 , -1.9 ,  1.81,
        0.81, -0.98,  1.45, -1.15,  0.08,  0.13]).reshape(30,2),       # X
        np.array([-0.93, -1.04, -1.17, -0.81, -1.09, -0.87, -0.94, -0.99, -0.93,
       -0.92, -0.88, -1.03, -1.23, -0.93, -0.99, -0.83, -0.91, -1.13,
       -0.99, -1.08, -0.96, -1.03, -0.96, -1.13, -0.98, -0.94, -0.84,
       -0.83, -1.14, -0.91,  1.13,  1.  ,  1.03,  0.97,  1.01,  1.16,
        1.08,  1.09,  1.05,  1.01,  0.9 ,  1.02,  1.06,  0.82,  1.04,
        1.11,  0.97,  1.19,  1.02,  1.06,  0.98,  1.08,  1.09,  0.95,
        1.08,  0.96,  1.08,  1.17,  1.07,  1.  ]).reshape(30,2),       # cluster 1
        np.array([-0.93, -1.04, -1.17, -1.05, -0.97, -0.91, -0.97, -0.86, -0.92,
       -1.03, -0.99, -0.97, -0.82, -0.92, -0.89, -0.96, -0.91, -0.9 ,
       -0.89, -0.94, -1.11, -1.02, -0.98, -1.12, -0.92, -1.14, -0.75,
       -1.1 , -0.8 , -0.99,  1.05,  0.95,  0.91,  1.06,  1.23,  0.95,
        1.02,  1.02,  1.04,  0.98,  1.06,  1.  ,  1.14,  1.  ,  0.9 ,
        0.76,  1.11,  1.03,  1.17,  1.23,  0.99,  1.16,  1.04,  1.08,
        0.84,  0.93,  1.  ,  1.13,  0.89,  1.04, -1.01,  1.04, -0.94,
        0.91, -0.98,  1.1 , -1.02,  1.08, -1.04,  0.8 , -1.02,  1.09,
        0.68, -1.02,  0.88, -1.03,  0.96, -1.07,  1.04, -0.87,  0.88,
       -1.08,  0.95, -0.95]).reshape(42,2),                            # cluster 2
       np.array([-0.54, -0.65, -1.25,  0.57,  0.69, -0.58, -0.68, -0.46,  0.76,
       -0.32,  0.11, -1.05, -0.15, -1.  ,  0.07, -0.99, -0.31, -0.82,
       -0.49, -0.82,  1.12,  0.3 , -0.98, -0.12,  0.66, -0.47,  1.08,
        0.12,  1.23,  0.85,  1.26,  0.8 , -1.19,  0.42,  0.34, -0.91,
        1.  ,  0.21,  1.08,  0.12,  0.12, -0.98, -0.02, -0.97, -1.28,
        0.76, -0.89, -0.14,  0.62, -0.49, -0.59, -0.75,  1.18,  0.43,
        0.98, -0.3 , -0.54, -0.91,  0.93, -0.2 ]).reshape(30,2),        # quadratic
        np.array([ 0.31,  0.44, -1.72, -1.36, -1.16, -1.13,  0.62,  0.81,  0.29,
       -0.18, -1.58, -1.77,  0.2 , -0.31,  0.45, -1.03,  1.01, -0.45,
        0.66, -0.22, -0.81,  0.62, -0.76,  0.1 ,  1.7 ,  0.8 , -1.25,
       -0.99, -0.41, -0.8 , -0.72,  1.29,  0.48, -1.57,  0.35,  0.53,
        0.88, -1.07,  0.58, -0.44, -0.11,  1.14, -0.73,  0.43,  0.39,
       -0.16,  1.61, -0.52,  0.15,  0.41, -0.81,  1.15, -0.35, -0.36,
       -1.68,  0.45,  0.74, -1.13, -0.37, -0.56]).reshape(30,2),        # zero correlation
       ]